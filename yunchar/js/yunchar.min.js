function createDataMap(t,e,a,n,i,o,r,s){this.ox=a,this.oy=n,this.w=i,this.h=o,this.gd=t,this.gd.DataMap=[],this.cm=e,this.imagebg,this.max=s,this.cbfun=function(){},this._cacheData=[],this.oHover=new hoverDataMap(t,this.cm,a,n,i,o,r,this.getCbfun,this)}function createMap(t,e,a){this.ox=t.ox*a,this.oy=t.oy*a,this.x=t.x,this.y=t.y,this.xrotate=t.x.rotate||0,this.tip,this.endx=this.ox+this.x.len*a,this.endy=this.oy-this.y.len*a,this.init(e)}function createTable(t,e){this.w=t,this.h=e,this.c=null,this.f=this.f||this.create()}function hoverDataMap(t,e,a,n,i,o,r,s,h){this.gd=t,this.ox=a,this.oy=n,this.w=i,this.h=o,this._map=e,this.MULTIPLE=r,this._cdm=h,this.cbfun=s||function(){}}function yunChar(t,e){var a=e.multiple||2,n=e.dataset,i=e.axes,o=e.max,r=new createTable(t.offsetWidth*a,t.offsetHeight*a);this.oCDM;var s=r.getTable();t.appendChild(s);var h=r.getCanvas().getContext("2d"),c=new createMap(i,h,a);c.setTip(e.tip),this.oCDM=new createDataMap(h,c,i.ox*a,(i.oy-i.y.len)*a,i.x.len*a,i.y.len*a,a,o);for(var l=0,u=n.length;u>l;l++)this.oCDM.drawDataMap(n[l].backgroundColor,n[l].data,n[l].data_x||[]);this.oCDM.starDraw(e.animation)}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),createDataMap.prototype.hoverCbfun=function(t){this.cbfun=t},createDataMap.prototype.getCbfun=function(t){this.cbfun.call(null,t)},createDataMap.prototype.drawDataMap=function(t,e,a){var n={},a=a||[],i=e;i.length,Math.max.apply(null,i);n.color=t,n.resdata=i,n.data_x=a,this.gd.DataMap.push(n),this.imagebg=this.cm.getImageBackground(this.gd),this.setCacheData(n)},createDataMap.prototype.setCacheData=function(t){this._cacheData.push(t)},createDataMap.prototype.getCacheData=function(){return this._cacheData},createDataMap.prototype.starDraw=function(t){var t=t,e=this.getCacheData();this.max=this.setScale(e),t?this.animation(e,function(){this.oHover.init()}):this.drawLine(this.gd,e,function(){this.oHover.init()})},createDataMap.prototype.setScale=function(t){for(var e,a=0,n=0;n<t.length;n++)a=a>(e=Math.max.apply(null,t[n].resdata))?a:e;a=this.max||a;for(var n=0;n<t.length;n++){t[n].d={};for(var i=0,o=t[n].resdata.length;o>i;i++){var r=(a-t[n].resdata[i])/a*(this.h-100)+this.oy+100,s=i/(o-1||1)*(this.w-80)+this.ox;t[n].d[parseInt(s)]={},t[n].d[parseInt(s)].v=t[n].resdata[i],t[n].d[parseInt(s)].v_x=t[n].data_x[i],t[n].d[parseInt(s)].x=s,t[n].d[parseInt(s)].y=r}}return a},createDataMap.prototype.drawLine=function(t,e,a){for(var a=a||function(){},n=0,i=e.length;i>n;n++){t.save(),t.beginPath(),t.translate(.5,.5),t.lineWidth=3;var o=e[n].resdata,r=0,s=o.length,h=this.max;t.strokeStyle=e[n].color;for(var c=0;s>c;c++)if(null===o[c])r=0;else{var l=(h-o[c])/h*(this.h-100)+this.oy+100,u=c/(s-1||1)*(this.w-80)+this.ox;0===r?t.moveTo(u,l):t.lineTo(u,l),r++}t.stroke(),t.restore()}a.apply(this)},createDataMap.prototype.animation=function(t,e){function a(){var e=i.ox,r=i.oy+i.h/2,s=i.ox+i.w-80,h=r;o++;var c=Math.tween.Quad.easeInOut(o,e,s,50);return i.gd.save(),i.gd.beginPath(),i.gd.translate(.5,.5),i.gd.lineWidth=3,i.gd.strokeStyle=t[0].color,i.gd.moveTo(e,r),i.gd.lineTo(c,h),i.gd.stroke(),i.gd.restore(),c>=s?(n.apply(i),!1):void requestAnimFrame(a)}function n(){function a(){i.cm.clearMap(i.gd),i.cm.setImageBackground(i.gd,i.imagebg);for(var o=0,r=t.length;r>o;o++){i.gd.save(),i.gd.beginPath(),i.gd.translate(.5,.5),i.gd.lineWidth=3,i.gd.strokeStyle=t[o].color;for(var s=t[o].resdata,h=0,c=0,l=s.length;l>c;c++){var u=i.max;if(null===s[c])h=0;else{var f=(u-s[c])/u*(i.h-100)+i.oy+100,p=i.oy+i.h/2,d=Math.tween.Quad.easeInOut(n,p,f-p,100),g=c/(l-1||0)*(i.w-80)+i.ox;0==h?i.gd.moveTo(g,d):i.gd.lineTo(g,d),h++}}i.gd.stroke(),i.gd.restore()}return n>=100||-100>=n?(e.apply(i),!1):(n++,void requestAnimFrame(a))}var n=1,i=this;a()}var i=this,o=1,e=e||function(){};a()},createDataMap.prototype.getDataImage=function(){var t=[],e=document.createElement("canvas");e.width=this.gd.canvas.width,e.height=this.gd.canvas.height;for(var a=e.getContext("2d"),n=0,i=this.getCacheData().length;i>n;n++){var o=[],r={};o.push(this.getCacheData()[n]),a.clearRect(0,0,e.width,e.height),this.drawLine(a,o,function(){}),r.src=e.toDataURL("image/png"),r.title=o[0].display_name,t.push(r)}return t},createMap.prototype.init=function(t){this.drawLine(t,this.ox,this.oy,this.ox,this.endy,"#cfcfcf"),this.drawLine(t,this.ox,this.oy,this.endx,this.oy,"#cfcfcf"),this.drawExplain(t,this.ox-10,this.endy,this.x.text.substring(0,2)),this.drawExplain(t,this.ox-10,this.endy+40,this.x.text.substring(2)),this.drawExplain(t,this.endx,this.oy+10,this.y.text),this.y.scale&&this.drawScale(t,this.ox,this.oy,this.endx,this.oy,this.x.data),this.x.scale&&this.drawScale(t,this.ox,this.oy,this.ox,this.endy,this.y.data),this.y.line&&this.drawScaleLine(t,this.ox,this.oy,this.endx,this.endy,"#f3f3f5",this.x.data,"vertical"),this.x.line&&this.drawScaleLine(t,this.ox,this.oy,this.endx,this.endy,"#f3f3f5",this.y.data,"horizontal")},createMap.prototype.drawLine=function(t,e,a,n,i,o){t.save(),t.translate(.5,.5),t.lineWidth=2,t.strokeStyle=o,t.beginPath(),t.moveTo(e,a),t.lineTo(n,i),t.stroke(),t.closePath(),t.restore()},createMap.prototype.drawExplain=function(t,e,a,n){t.save(),t.beginPath(),t.fillStyle="#3c3c3c",t.font="26px a",t.textAlign="right",t.textBaseline="top",t.translate(.5,.5),t.fillText(n,e,a),t.stroke(),t.restore()},createMap.prototype.drawScale=function(t,e,a,n,i,o){var r=e==n?"vertical":"horizontal",s=o.length;if(!this.xrotate%360||"vertical"==r){t.save(),t.beginPath(),t.fillStyle="#3c3c3c",t.font="26px a",t.textAlign="right",t.textBaseline="top",t.translate(.5,.5);for(var h=0;s>h;h++)if("vertical"==r){var c=(i-a+100)/(s-1||0);t.fillText(o[h],e-10,a+c*h-20)}else{t.rotate(this.xrotate*Math.PI/180);var c=(n-e-80)/(s-1||0);t.fillText(o[h],e+c*h+20,a+10)}t.stroke(),t.restore()}else for(var h=0;s>h;h++){t.save(),t.beginPath(),t.fillStyle="#3c3c3c",t.font="26px a",t.textAlign="right",t.textBaseline="top";var c=(n-e-80)/(s-1||0),l=t.measureText(o[h]).width,u=this.xrotate*Math.PI/180,f=e+c*h+l*Math.cos(u),p=a+l*Math.sin(u);t.translate(f,p),t.rotate(u),t.fillText(o[h],0,0),t.translate(-f,-p),t.stroke(),t.restore()}},createMap.prototype.drawScaleLine=function(t,e,a,n,i,o,r,s){var h=s,c=r.length;t.save(),t.lineWidth=2,t.strokeStyle=o,t.translate(.5,.5);for(var l=0;c>l;l++){if(t.beginPath(),"vertical"==h){var u=(n-e-80)/(c-1||0),f=e+l*u;t.moveTo(f,a),t.lineTo(f,i)}else{var u=(i-a+100)/(c-1||0),p=a+l*u;t.moveTo(e,p),t.lineTo(n,p)}t.stroke(),t.closePath()}t.restore()},createMap.prototype.setTip=function(t){this.tip=t},createMap.prototype.clearMap=function(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)},createMap.prototype.getImageBackground=function(t){var e=new Image;return e.src=t.canvas.toDataURL("image/png"),e},createMap.prototype.setImageBackground=function(t,e){t.drawImage(e,0,0)},CanvasRenderingContext2D.prototype.roundRect=function(t,e,a,n,i){return 2*i>a&&(i=a/2),2*i>n&&(i=n/2),this.beginPath(),this.moveTo(t+i,e),this.arcTo(t+a,e,t+a,e+n,i),this.arcTo(t+a,e+n,t,e+n,i),this.arcTo(t,e+n,t,e,i),this.arcTo(t,e,t+a,e,i),this.closePath(),this},createTable.prototype.create=function(){var t=document.createDocumentFragment();return this.c=document.createElement("canvas"),this.c.width=this.w,this.c.height=this.h,this.c.style.width="100%",this.c.style.height="100%",t.appendChild(this.c),t},createTable.prototype.getTable=function(){return this.f},createTable.prototype.getCanvas=function(){return this.c},hoverDataMap.prototype.init=function(){this.oImagebase=this._map.getImageBackground(this.gd),this.mousemove(this.gd)},hoverDataMap.prototype.drawTip=function(t,e,a,n){var i,o,r=this._map.tip.width,s=this._map.tip.height,e=e,a=a,h=-s/2,c=60,l=n.style,u=n.title,f=n.data;switch(l){case"table-tip-style1":i="rgba(190,236,253,.5)",o="#7fd9fb";break;case"table-tip-style2":i="rgba(253,240,218,.5)",o="#f13b3b"}t.save(),t.beginPath(),t.fillStyle="#EB852A",t.shadowOffsetX=5,t.shadowOffsetY=5,t.shadowBlur=14,t.shadowColor="rgba(0, 0, 0, 0.2)",t.fillStyle=i,t.textBaseline="middle",e>this.ox+this.w-r?(t.roundRect(e-r-c,a+h,r,s,20).fill(),t.moveTo(e-c-5,a-30),t.lineTo(e-c-5+20,a),t.lineTo(e-c-5,a+30),t.fill(),t.beginPath(),t.fillStyle=o,t.strokeStyle="#fff",t.lineWidth=3,t.arc(e-c-5,a,8,0,2*Math.PI),t.fill(),t.stroke(),t.beginPath(),t.fillStyle="#3c3c3c",t.font="26px a",t.textAlign="left",t.translate(.5,.5),1==f.length?(t.fillText(u,e-r-c+20,a+h/2),t.fillText(f[0],e-r-c+20,a-h/2),t.stroke()):(t.fillText(u,e-r-c+20,a+h/2),t.fillText(f[0],e-r-c+20,a),t.stroke(),t.fillStyle="#f13b3b",t.fillText(f[1],e-r-c+20,a-h/2),t.stroke()),t.restore()):(t.roundRect(e+c,a+h,r,s,20).fill(),t.moveTo(e+c+5,a-30),t.lineTo(e+c+5-20,a),t.lineTo(e+c+5,a+30),t.fill(),t.beginPath(),t.fillStyle=o,t.strokeStyle="#fff",t.lineWidth=3,t.arc(e+c+5,a,8,0,2*Math.PI),t.fill(),t.stroke(),t.beginPath(),t.fillStyle="#3c3c3c",t.font="26px a",t.textAlign="left",t.translate(.5,.5),1==f.length?(t.fillText(u,e+c+20,a+h/2),t.fillText(f[0],e+c+20,a-h/2),t.stroke()):(t.fillText(u,e+c+20,a+h/2),t.fillText(f[0],e+c+20,a),t.stroke(),t.fillStyle="#f13b3b",t.fillText(f[1],e+c+20,a-h/2),t.stroke()),t.restore())},hoverDataMap.prototype.hoverPoint=function(t,e,a,n){t.save(),t.beginPath(),t.fillStyle="#fff",t.lineWidth=4,t.strokeStyle=n,t.arc(e,a,6,0,2*Math.PI),t.fill(),t.stroke(),t.restore()},hoverDataMap.prototype.drawDataPoint=function(t,e,a,n){var i=this._map;i.clearMap(t),i.setImageBackground(t,n);for(var o=e,r=i.tip.unit,s=new RegExp("\\"+r+"x\\"+r,"g"),h=new RegExp("\\"+r+"y\\"+r,"g"),c=this.cbfun,l={style:i.tip.style,title:i.tip.title},u=i.tip.data,f=[],p=i.endx,d=i.tip.vector,g=0,v=u.length;v>g;g++){for(var y=t.DataMap[g],x={};o>0&&p>=o&&!(x=y.d[~~o]);)"left"==d?o--:(o++,o>=p&&(o--,d="left"));d=i.tip.vector;var M="";x&&x.v&&(l.title=i.tip.title.replace(s,x.v_x).replace(h,x.v),M=u[g].replace(s,x.v_x).replace(h,x.v)),f.push(M),this.hoverPoint(t,x.x,x.y,y.color)}l.data=f,c.call(this._cdm,x),i.tip.show&&this.drawTip(t,e,a,l)},hoverDataMap.prototype.mousemove=function(t){var e=this,a=this._map,n=this.oImagebase;t.canvas.onmousemove=function(i){var o=(this.parentNode.getBoundingClientRect().left||this.parentNode.offsetLeft)+(document.body.scrollLeft||document.documentElement.scrollLeft),r=(this.parentNode.getBoundingClientRect().top||this.parentNode.offsetTop)+(document.body.scrollTop||document.documentElement.scrollTop),s=(i.pageX-o)*e.MULTIPLE,h=(i.pageY-r)*e.MULTIPLE;return h>e.oy+e.h||h<e.oy||s<e.ox||s>e.ox+e.w?(n&&(a.clearMap(t),a.setImageBackground(t,n)),!1):void(n&&e.drawDataPoint(t,s,h,n))},t.canvas.onmouseover=function(){},t.canvas.onmouseout=function(){n&&(a.clearMap(t),a.setImageBackground(t,n))}},yunChar.prototype.getDataImage=function(){return this.oCDM.getDataImage()},yunChar.prototype.hoverCbfun=function(t){this.oCDM.hoverCbfun(t)};var Tween={Linear:function(t,e,a,n){return a*t/n+e},Quad:{easeIn:function(t,e,a,n){return a*(t/=n)*t+e},easeOut:function(t,e,a,n){return-a*(t/=n)*(t-2)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t+e:-a/2*(--t*(t-2)-1)+e}},Cubic:{easeIn:function(t,e,a,n){return a*(t/=n)*t*t+e},easeOut:function(t,e,a,n){return a*((t=t/n-1)*t*t+1)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t+e:a/2*((t-=2)*t*t+2)+e}},Quart:{easeIn:function(t,e,a,n){return a*(t/=n)*t*t*t+e},easeOut:function(t,e,a,n){return-a*((t=t/n-1)*t*t*t-1)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t*t+e:-a/2*((t-=2)*t*t*t-2)+e}},Quint:{easeIn:function(t,e,a,n){return a*(t/=n)*t*t*t*t+e},easeOut:function(t,e,a,n){return a*((t=t/n-1)*t*t*t*t+1)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?a/2*t*t*t*t*t+e:a/2*((t-=2)*t*t*t*t+2)+e}},Sine:{easeIn:function(t,e,a,n){return-a*Math.cos(t/n*(Math.PI/2))+a+e},easeOut:function(t,e,a,n){return a*Math.sin(t/n*(Math.PI/2))+e},easeInOut:function(t,e,a,n){return-a/2*(Math.cos(Math.PI*t/n)-1)+e}},Expo:{easeIn:function(t,e,a,n){return 0==t?e:a*Math.pow(2,10*(t/n-1))+e},easeOut:function(t,e,a,n){return t==n?e+a:a*(-Math.pow(2,-10*t/n)+1)+e},easeInOut:function(t,e,a,n){return 0==t?e:t==n?e+a:(t/=n/2)<1?a/2*Math.pow(2,10*(t-1))+e:a/2*(-Math.pow(2,-10*--t)+2)+e}},Circ:{easeIn:function(t,e,a,n){return-a*(Math.sqrt(1-(t/=n)*t)-1)+e},easeOut:function(t,e,a,n){return a*Math.sqrt(1-(t=t/n-1)*t)+e},easeInOut:function(t,e,a,n){return(t/=n/2)<1?-a/2*(Math.sqrt(1-t*t)-1)+e:a/2*(Math.sqrt(1-(t-=2)*t)+1)+e}},Elastic:{easeIn:function(t,e,a,n,i,o){var r;return 0==t?e:1==(t/=n)?e+a:("undefined"==typeof o&&(o=.3*n),!i||i<Math.abs(a)?(r=o/4,i=a):r=o/(2*Math.PI)*Math.asin(a/i),-(i*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o))+e)},easeOut:function(t,e,a,n,i,o){var r;return 0==t?e:1==(t/=n)?e+a:("undefined"==typeof o&&(o=.3*n),!i||i<Math.abs(a)?(i=a,r=o/4):r=o/(2*Math.PI)*Math.asin(a/i),i*Math.pow(2,-10*t)*Math.sin((t*n-r)*(2*Math.PI)/o)+a+e)},easeInOut:function(t,e,a,n,i,o){var r;return 0==t?e:2==(t/=n/2)?e+a:("undefined"==typeof o&&(o=n*(.3*1.5)),!i||i<Math.abs(a)?(i=a,r=o/4):r=o/(2*Math.PI)*Math.asin(a/i),1>t?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o))+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*n-r)*(2*Math.PI)/o)*.5+a+e)}},Back:{easeIn:function(t,e,a,n,i){return"undefined"==typeof i&&(i=1.70158),a*(t/=n)*t*((i+1)*t-i)+e},easeOut:function(t,e,a,n,i){return"undefined"==typeof i&&(i=1.70158),a*((t=t/n-1)*t*((i+1)*t+i)+1)+e},easeInOut:function(t,e,a,n,i){return"undefined"==typeof i&&(i=1.70158),(t/=n/2)<1?a/2*(t*t*(((i*=1.525)+1)*t-i))+e:a/2*((t-=2)*t*(((i*=1.525)+1)*t+i)+2)+e}},Bounce:{easeIn:function(t,e,a,n){return a-Tween.Bounce.easeOut(n-t,0,a,n)+e},easeOut:function(t,e,a,n){return(t/=n)<1/2.75?a*(7.5625*t*t)+e:2/2.75>t?a*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?a*(7.5625*(t-=2.25/2.75)*t+.9375)+e:a*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOut:function(t,e,a,n){return n/2>t?.5*Tween.Bounce.easeIn(2*t,0,a,n)+e:.5*Tween.Bounce.easeOut(2*t-n,0,a,n)+.5*a+e}}};Math.tween=Tween;